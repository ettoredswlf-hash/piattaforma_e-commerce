{% extends "catalog/base.html" %}

{% block content %}
<h2>Cart</h2>

{% if cart|length == 0 %}
  <p>Cart is empty</p>
{% else %}
  <table border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr>
        <th>Product</th>
        <th>Qty</th>
        <th>Unit price</th>
        <th>Line total</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      {% for item in cart %}
      <tr>
        <td>{{ item.product.name }}</td>

        <td style="white-space: nowrap;">
          <!-- Bottone - -->
          <form method="post" action="{% url 'shopping_cart:cart_update' item.product.id %}" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="qty" value="{{ item.qty|add:'-1' }}">
            <button type="submit">−</button>
          </form>

          <strong style="margin: 0 10px;">{{ item.qty }}</strong>

          <!-- Bottone + -->
          <form method="post" action="{% url 'shopping_cart:cart_update' item.product.id %}" style="display:inline;">
            {% csrf_token %}
            <input type="hidden" name="qty" value="{{ item.qty|add:'1' }}">
            <button type="submit">+</button>
          </form>
        </td>

        <td>€{{ item.price }}</td>
        <td>€{{ item.total_price }}</td>

        <td>
          <a href="{% url 'shopping_cart:cart_remove' item.product.id %}">Remove</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p><strong>Total:</strong> €{{ cart.get_total_price }}</p>

  <p><a href="{% url 'orders:order_create' %}">Proceed to checkout</a></p>
{% endif %}
{% endblock %}
